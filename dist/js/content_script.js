(()=>{"use strict";var __webpack_modules__={318:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function processElement(element,recipe,parentName="",nthChild=0){let tagName=recipe.tag_name||element.tagName.toLowerCase();tagName.endsWith("_")&&(tagName=tagName.slice(0,-1));const newElement=document.createElement(tagName);let elementText="";if(recipe.text_selector){const e=element.querySelector(recipe.text_selector);e&&(elementText=e.innerText||e.textContent||"")}else recipe.text_js?elementText=eval(recipe.text_js):recipe.add_text&&(elementText=element.innerText||element.textContent||"");elementText=elementText.replace(/\s+/g," ").trim(),recipe.text_format&&elementText&&(elementText=recipe.text_format.replace("{}",elementText)),elementText&&recipe.add_text&&(newElement.textContent=elementText);let elementName="";if(recipe.name&&("from_text"===recipe.name?(elementName=parentName?parentName+".":"",elementName+=elementText.toLowerCase().replace(/[^\w]+/g,"_")):"from_nth_child"===recipe.name?(elementName=parentName?parentName+".":"",elementName+=nthChild.toString()):(elementName=parentName?parentName+".":"",elementName+=recipe.name),newElement.setAttribute("name",elementName),parentName=elementName),recipe.clickable){if(!recipe.name)throw new Error("clickable element must have a name");let e;e=recipe.click_selector?element.querySelector(recipe.click_selector):element,e?e.setAttribute("data-clickable-id",elementName):console.log("click-element not found",element,recipe),window.clickable_recipes||(window.clickable_recipes={}),window.clickable_recipes[elementName]=recipe}if("input"===tagName){const e=element.getAttribute("type");["text","number"].includes(e)?(newElement.setAttribute("value",element.value),element.setAttribute("data-input-id",elementName)):"checkbox"===e?newElement.setAttribute("checked",element.checked.toString()):"radio"===e&&(newElement.setAttribute("checked",element.checked.toString()),element.setAttribute("data-clickable-id",elementName)),window.input_recipes||(window.input_recipes={}),window.input_recipes[elementName]=recipe}if("select"===tagName){element.setAttribute("data-select-id",elementName);const e=element.querySelectorAll("option");e.forEach((e=>{const t=e.getAttribute("value")||e.textContent.trim(),n=elementName+"."+t,r=document.createElement("option");r.textContent=e.textContent,r.setAttribute("value",t),r.setAttribute("name",n),r.setAttribute("selected",e.selected.toString()),e.setAttribute("data-clickable-id",n),newElement.appendChild(r)}))}const attrsToCopy=["alt","title","type","value","role","aria-label","aria-hidden","aria-selected"];if(attrsToCopy.forEach((e=>{const t=element.getAttribute(e);t&&newElement.setAttribute(e,t)})),recipe.keep_attr)for(const e in recipe.keep_attr){const t=element.getAttribute(e);t&&newElement.setAttribute(e,t)}if(recipe.class&&newElement.setAttribute("class",recipe.class),recipe.id&&newElement.setAttribute("id",recipe.id),recipe.override_attr)for(const key in recipe.override_attr)newElement.setAttribute(key,eval(recipe.override_attr[key]));if(recipe.children&&recipe.children.length>0)for(const e of recipe.children){const t=e.direct_child?`:scope > ${e.selector}`:e.selector,n=element.querySelectorAll(t);n.forEach(((t,n)=>{const r=processElement(t,e,parentName,n);if(newElement.appendChild(r),e.insert_split_marker&&n%(e.insert_split_marker_every||1)==0){const e=document.createElement("split-marker");newElement.appendChild(e)}if(e.insert_split_marker){const e=document.createElement("split-marker");newElement.appendChild(e)}else console.log("no split marker")}))}if(recipe.empty_message&&0===newElement.children.length){const e=document.createTextNode(recipe.empty_message);newElement.appendChild(e)}return newElement}__webpack_require__.d(__webpack_exports__,{q:()=>processElement})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={},_utils_element_processor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(318),__awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((r=r.apply(e,t||[])).next())}))};function captureScreenshot(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=`screenshot_${e}`,n=yield chrome.runtime.sendMessage({action:"captureScreenshot",screenshotId:t});if(!n.success)throw new Error(n.message||"Screenshot capture failed");window.postMessage({type:"SCREENSHOT_COMPLETE",timestamp:e,success:!0},"*")}catch(t){console.error("捕获截图时出错:",t),window.postMessage({type:"SCREENSHOT_COMPLETE",timestamp:e,success:!1,error:t.message},"*")}}))}window.addEventListener("message",(e=>__awaiter(void 0,void 0,void 0,(function*(){if(e.source===window&&(e.data.type&&"CAPTURE_SCREENSHOT"===e.data.type&&(yield captureScreenshot(e.data.timestamp)),e.data.type&&"SAVE_INTERACTION_DATA"===e.data.type))try{const t=yield chrome.storage.local.get(["htmlSnapshots"],(t=>{const n=t.htmlSnapshots||{};n[e.data.data.htmlSnapshotId]=e.data.data.htmlContent,chrome.storage.local.set({htmlSnapshots:n})}));console.log(t);const n=Object.assign({},e.data.data);delete n.htmlContent;const r=yield chrome.runtime.sendMessage({action:"saveData",data:n});if(!t.success||!r.success)throw new Error(t.message+r.message||"interaction capture failed");console.log(r),window.postMessage({type:"INTERACTION_COMPLETE",timestamp:e.data.data.timestamp,success:!0},"*")}catch(t){console.error("Error saving interaction data:",t),window.postMessage({type:"INTERACTION_COMPLETE",success:!1,error:t.message,timestamp:e.data.data.timestamp},"*")}}))));let lastScrollTime=0;const SCROLL_THRESHOLD=1500;function generateHtmlSnapshotId(){const e=window.location.href,t=(new Date).toISOString();return`html_${hashCode(e)}_${t}`}function hashCode(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return console.log("Hash value before return:",t),t.toString()}function getClickableElementsInViewport(){const e=[];return document.querySelectorAll('a, button, [onclick], input[type="button"], input[type="submit"]').forEach((t=>{const n=t.getBoundingClientRect();n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)&&e.push({tagName:t.tagName,className:t.className,id:t.id,innerText:t.innerText.trim(),outerHTML:t.outerHTML.trim()})})),e}function captureInteraction(e,t,n,r,o,i){return __awaiter(this,void 0,void 0,(function*(){try{const c=generateHtmlSnapshotId();yield new Promise(((e,t)=>{chrome.storage.local.get(["htmlSnapshots"],(n=>{const r=n.htmlSnapshots||{};r[c]=document.documentElement.outerHTML,chrome.storage.local.set({htmlSnapshots:r},(()=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(void 0)}))}))}));const a={eventType:e,timestamp:n,target:t,targetOuterHTML:t.outerHTML,targetClass:t.className,targetId:t.id,targetText:t.innerText||t.value||"",htmlSnapshotId:c,selector:r||"",clickableId:o||"",url:i||""};yield chrome.runtime.sendMessage({action:"saveData",data:a})}catch(t){console.error(`Error during ${e} event handling:`,t)}}))}function getUniqueSelector(e){if(e.id)return`#${e.id}`;if(e.className){const t=e.className.trim().split(/\s+/).join(".");return`${e.tagName.toLowerCase()}.${t}`}return e.tagName.toLowerCase()}function getFullSelector(e){let t=[];for(;e.parentElement;)t.unshift(getUniqueSelector(e)),e=e.parentElement;return t.join(" > ")}document.addEventListener("DOMContentLoaded",(()=>__awaiter(void 0,void 0,void 0,(function*(){console.log("DOMContentLoaded");const e=window.location.href;try{const t=yield new Promise((t=>{chrome.runtime.sendMessage({action:"getRecipe",url:e},t)}));if(console.log("response"),t&&t.recipe){const e=t.recipe,n=document.querySelector(e.selector);if(n){const t=(0,_utils_element_processor__WEBPACK_IMPORTED_MODULE_0__.q)(n,e);console.log(t.outerHTML)}}}catch(e){console.error("Error initializing clickable elements:",e)}})))),document.addEventListener("scroll",(e=>__awaiter(void 0,void 0,void 0,(function*(){try{const t=Date.now();if(t-lastScrollTime>=SCROLL_THRESHOLD){lastScrollTime=t;const n=(new Date).toISOString();yield captureInteraction("scroll",e.target,n,"","",""),yield captureScreenshot(n)}}catch(e){console.error("Error during scroll event handling:",e)}})))),document.addEventListener("blur",(e=>__awaiter(void 0,void 0,void 0,(function*(){const t=e.target;if(t&&("INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName)){const e=(new Date).toISOString();yield captureScreenshot(e),yield captureInteraction("input",t,e,"","","")}}))),!0),document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll('input[id="placeOrder"], input[id="turbo-checkout-pyo-button"]');const e=document.querySelector('input[id="buy-now-button"]'),t=document.querySelector('button[id="rcx-subscribe-submit-button-announce"]'),n=document.querySelector('input[name="proceedToRetailCheckout"]');[e,t].forEach((e=>{e&&e.addEventListener("click",(()=>__awaiter(void 0,void 0,void 0,(function*(){var t,n,r,o,i;try{const c={title:(null===(n=null===(t=document.querySelector("#title"))||void 0===t?void 0:t.innerText)||void 0===n?void 0:n.trim())||"",price:(null===(o=null===(r=document.querySelector("span.a-price.aok-align-center.reinventPricePriceToPayMargin.priceToPay"))||void 0===r?void 0:r.innerText)||void 0===o?void 0:o.trim())||"",asin:(null===(i=document.querySelector("input#ASIN"))||void 0===i?void 0:i.value)||"",options:{}};Array.from(document.querySelectorAll("#twister div.a-row:has(label.a-form-label):has(span.selection)")).forEach((e=>{var t,n,r;const o=(null===(n=null===(t=e.querySelector("label.a-form-label"))||void 0===t?void 0:t.innerText)||void 0===n?void 0:n.replace(": ",""))||"",i=(null===(r=e.querySelector("span.selection"))||void 0===r?void 0:r.innerText)||"";o&&i&&(c.options[o]=i)})),console.log(`${e.id} clicked - Product Info:`,c);const a=(yield chrome.storage.local.get({orderDetails:[]})).orderDetails||[];a.push({name:c.title,price:parseFloat(c.price.replace(/[^0-9.]/g,"")),asin:c.asin,options:c.options}),yield chrome.storage.local.set({orderDetails:a})}catch(t){console.error(`Error capturing ${e.id} product info:`,t)}}))))})),n&&n.addEventListener("click",(e=>__awaiter(void 0,void 0,void 0,(function*(){var e,t,n;try{const r=[],o=Array.from(document.querySelectorAll('[id^="sc-active-"]')).filter((e=>"sc-active-cart"!==e.id));for(const i of o){const o=i.querySelector('input[type="checkbox"]');if(o&&o.checked){const o=i.querySelector(".sc-item-product-title-cont .sc-product-link");if(o){const c=o.querySelector(".a-truncate-full"),a=(null===(e=null==c?void 0:c.textContent)||void 0===e?void 0:e.trim())||"",l=(null===(t=(o.getAttribute("href")||"").match(/product\/([A-Z0-9]{10})/))||void 0===t?void 0:t[1])||"",s=i.querySelector(".sc-item-price-block .a-offscreen"),m=s?parseFloat((null===(n=s.textContent)||void 0===n?void 0:n.replace(/[^0-9.]/g,""))||"0"):0,d={};i.querySelectorAll(".sc-product-variation").forEach((e=>{var t,n,r,o;const i=(null===(n=null===(t=e.querySelector(".a-text-bold"))||void 0===t?void 0:t.textContent)||void 0===n?void 0:n.trim().replace(":",""))||"",c=(null===(o=null===(r=e.querySelector(".a-size-small:not(.a-text-bold)"))||void 0===r?void 0:r.textContent)||void 0===o?void 0:o.trim())||"";i&&c&&(d[i]=c)})),r.push({name:a,asin:l,price:m,options:d})}}}if(r.length>0){const e=((yield chrome.storage.local.get({orderDetails:[]})).orderDetails||[]).concat(r);yield chrome.storage.local.set({orderDetails:e}),console.log("Stored selected cart items:",r)}}catch(e){console.error("Error capturing selected cart items:",e)}}))))})),chrome.runtime.onMessage.addListener(((e,t,n)=>("getHTML"===e.action&&n({html:document.documentElement.outerHTML}),!0)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL3NyYy91dGlscy9lbGVtZW50LXByb2Nlc3Nvci50cyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL3NyYy9jb250ZW50X3NjcmlwdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gcHJvY2Vzc0VsZW1lbnQoZWxlbWVudCwgcmVjaXBlLCBwYXJlbnROYW1lID0gXCJcIiwgbnRoQ2hpbGQgPSAwKSB7XG4gICAgLy8gQ3JlYXRlIGEgbmV3IGVsZW1lbnQgdXNpbmcgdGhlIERPTSBBUElcbiAgICBsZXQgdGFnTmFtZSA9IHJlY2lwZS50YWdfbmFtZSB8fCBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAvLyBIYW5kbGUgdW5kZXJzY29yZWQgdGFnc1xuICAgIGlmICh0YWdOYW1lLmVuZHNXaXRoKFwiX1wiKSkge1xuICAgICAgICB0YWdOYW1lID0gdGFnTmFtZS5zbGljZSgwLCAtMSk7XG4gICAgfVxuICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICAgIC8vIEV4dHJhY3QgdGV4dCBjb250ZW50IGJhc2VkIG9uIHRoZSByZWNpcGVcbiAgICBsZXQgZWxlbWVudFRleHQgPSBcIlwiO1xuICAgIGlmIChyZWNpcGUudGV4dF9zZWxlY3Rvcikge1xuICAgICAgICBjb25zdCB0ZXh0RWxlbWVudCA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcihyZWNpcGUudGV4dF9zZWxlY3Rvcik7XG4gICAgICAgIGlmICh0ZXh0RWxlbWVudCkge1xuICAgICAgICAgICAgZWxlbWVudFRleHQgPSB0ZXh0RWxlbWVudC5pbm5lclRleHQgfHwgdGV4dEVsZW1lbnQudGV4dENvbnRlbnQgfHwgXCJcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChyZWNpcGUudGV4dF9qcykge1xuICAgICAgICBlbGVtZW50VGV4dCA9IGV2YWwocmVjaXBlLnRleHRfanMpO1xuICAgIH1cbiAgICBlbHNlIGlmIChyZWNpcGUuYWRkX3RleHQpIHtcbiAgICAgICAgZWxlbWVudFRleHQgPSBlbGVtZW50LmlubmVyVGV4dCB8fCBlbGVtZW50LnRleHRDb250ZW50IHx8IFwiXCI7XG4gICAgfVxuICAgIGVsZW1lbnRUZXh0ID0gZWxlbWVudFRleHQucmVwbGFjZSgvXFxzKy9nLCBcIiBcIikudHJpbSgpO1xuICAgIGlmIChyZWNpcGUudGV4dF9mb3JtYXQgJiYgZWxlbWVudFRleHQpIHtcbiAgICAgICAgZWxlbWVudFRleHQgPSByZWNpcGUudGV4dF9mb3JtYXQucmVwbGFjZShcInt9XCIsIGVsZW1lbnRUZXh0KTtcbiAgICB9XG4gICAgaWYgKGVsZW1lbnRUZXh0ICYmIHJlY2lwZS5hZGRfdGV4dCkge1xuICAgICAgICBuZXdFbGVtZW50LnRleHRDb250ZW50ID0gZWxlbWVudFRleHQ7XG4gICAgfVxuICAgIC8vIEJ1aWxkIHRoZSBub2RlIGF0dHJpYnV0ZXNcbiAgICBsZXQgZWxlbWVudE5hbWUgPSBcIlwiO1xuICAgIGlmIChyZWNpcGUubmFtZSkge1xuICAgICAgICBpZiAocmVjaXBlLm5hbWUgPT09IFwiZnJvbV90ZXh0XCIpIHtcbiAgICAgICAgICAgIGVsZW1lbnROYW1lID0gcGFyZW50TmFtZSA/IHBhcmVudE5hbWUgKyBcIi5cIiA6IFwiXCI7XG4gICAgICAgICAgICBlbGVtZW50TmFtZSArPSBlbGVtZW50VGV4dC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teXFx3XSsvZywgXCJfXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlY2lwZS5uYW1lID09PSBcImZyb21fbnRoX2NoaWxkXCIpIHtcbiAgICAgICAgICAgIGVsZW1lbnROYW1lID0gcGFyZW50TmFtZSA/IHBhcmVudE5hbWUgKyBcIi5cIiA6IFwiXCI7XG4gICAgICAgICAgICBlbGVtZW50TmFtZSArPSBudGhDaGlsZC50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZWxlbWVudE5hbWUgPSBwYXJlbnROYW1lID8gcGFyZW50TmFtZSArIFwiLlwiIDogXCJcIjtcbiAgICAgICAgICAgIGVsZW1lbnROYW1lICs9IHJlY2lwZS5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIG5ld0VsZW1lbnQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBlbGVtZW50TmFtZSk7XG4gICAgICAgIHBhcmVudE5hbWUgPSBlbGVtZW50TmFtZTtcbiAgICB9XG4gICAgLy8gSGFuZGxlIGNsaWNrYWJsZXMgYW5kIGlucHV0c1xuICAgIGlmIChyZWNpcGUuY2xpY2thYmxlKSB7XG4gICAgICAgIGlmICghcmVjaXBlLm5hbWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNsaWNrYWJsZSBlbGVtZW50IG11c3QgaGF2ZSBhIG5hbWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaGFuZGxlIGNsaWNrX3NlbGVjdG9yXG4gICAgICAgIGxldCBjbGlja19lbGVtZW50O1xuICAgICAgICBpZiAocmVjaXBlLmNsaWNrX3NlbGVjdG9yKSB7XG4gICAgICAgICAgICBjbGlja19lbGVtZW50ID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKHJlY2lwZS5jbGlja19zZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbGlja19lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xpY2tfZWxlbWVudCkge1xuICAgICAgICAgICAgY2xpY2tfZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWNsaWNrYWJsZS1pZFwiLCBlbGVtZW50TmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2xpY2stZWxlbWVudCBub3QgZm91bmQnLCBlbGVtZW50LCByZWNpcGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghd2luZG93LmNsaWNrYWJsZV9yZWNpcGVzKSB7XG4gICAgICAgICAgICB3aW5kb3cuY2xpY2thYmxlX3JlY2lwZXMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuY2xpY2thYmxlX3JlY2lwZXNbZWxlbWVudE5hbWVdID0gcmVjaXBlO1xuICAgIH1cbiAgICBpZiAodGFnTmFtZSA9PT0gXCJpbnB1dFwiKSB7XG4gICAgICAgIGNvbnN0IGlucHV0VHlwZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidHlwZVwiKTtcbiAgICAgICAgaWYgKFtcInRleHRcIiwgXCJudW1iZXJcIl0uaW5jbHVkZXMoaW5wdXRUeXBlKSkge1xuICAgICAgICAgICAgbmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBlbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1pbnB1dC1pZFwiLCBlbGVtZW50TmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXRUeXBlID09PSBcImNoZWNrYm94XCIpIHtcbiAgICAgICAgICAgIG5ld0VsZW1lbnQuc2V0QXR0cmlidXRlKFwiY2hlY2tlZFwiLCBlbGVtZW50LmNoZWNrZWQudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXRUeXBlID09PSBcInJhZGlvXCIpIHtcbiAgICAgICAgICAgIG5ld0VsZW1lbnQuc2V0QXR0cmlidXRlKFwiY2hlY2tlZFwiLCBlbGVtZW50LmNoZWNrZWQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImRhdGEtY2xpY2thYmxlLWlkXCIsIGVsZW1lbnROYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXdpbmRvdy5pbnB1dF9yZWNpcGVzKSB7XG4gICAgICAgICAgICB3aW5kb3cuaW5wdXRfcmVjaXBlcyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5pbnB1dF9yZWNpcGVzW2VsZW1lbnROYW1lXSA9IHJlY2lwZTtcbiAgICB9XG4gICAgLy8gKipIYW5kbGUgc2VsZWN0IGVsZW1lbnRzKipcbiAgICBpZiAodGFnTmFtZSA9PT0gXCJzZWxlY3RcIikge1xuICAgICAgICAvLyBUYWcgdGhlIHNlbGVjdCBlbGVtZW50IHdpdGggZGF0YS1zZWxlY3QtaWRcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNlbGVjdC1pZFwiLCBlbGVtZW50TmFtZSk7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ29wdGlvbicpO1xuICAgICAgICBvcHRpb25zLmZvckVhY2goKG9wdGlvbikgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uVmFsdWUgPSBvcHRpb24uZ2V0QXR0cmlidXRlKCd2YWx1ZScpIHx8IG9wdGlvbi50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25OYW1lID0gZWxlbWVudE5hbWUgKyBcIi5cIiArIG9wdGlvblZhbHVlO1xuICAgICAgICAgICAgY29uc3QgbmV3T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgICAgICBuZXdPcHRpb24udGV4dENvbnRlbnQgPSBvcHRpb24udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICBuZXdPcHRpb24uc2V0QXR0cmlidXRlKCd2YWx1ZScsIG9wdGlvblZhbHVlKTtcbiAgICAgICAgICAgIG5ld09wdGlvbi5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBvcHRpb25OYW1lKTtcbiAgICAgICAgICAgIG5ld09wdGlvbi5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgb3B0aW9uLnNlbGVjdGVkLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgb3B0aW9uLnNldEF0dHJpYnV0ZSgnZGF0YS1jbGlja2FibGUtaWQnLCBvcHRpb25OYW1lKTsgLy8gVGFnIGFjdHVhbCBET00gb3B0aW9uIGVsZW1lbnRcbiAgICAgICAgICAgIG5ld0VsZW1lbnQuYXBwZW5kQ2hpbGQobmV3T3B0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIENvcHkgc3BlY2lmaWVkIGF0dHJpYnV0ZXNcbiAgICBjb25zdCBhdHRyc1RvQ29weSA9IFtcImFsdFwiLCBcInRpdGxlXCIsIFwidHlwZVwiLCBcInZhbHVlXCIsIFwicm9sZVwiLCBcImFyaWEtbGFiZWxcIiwgXCJhcmlhLWhpZGRlblwiLCBcImFyaWEtc2VsZWN0ZWRcIl07XG4gICAgYXR0cnNUb0NvcHkuZm9yRWFjaCgoYXR0cikgPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHIpO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIG5ld0VsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChyZWNpcGUua2VlcF9hdHRyKSB7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJlY2lwZS5rZWVwX2F0dHIpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoa2V5KTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIG5ld0VsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChyZWNpcGVbJ2NsYXNzJ10pIHtcbiAgICAgICAgbmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgcmVjaXBlWydjbGFzcyddKTtcbiAgICB9XG4gICAgaWYgKHJlY2lwZVsnaWQnXSkge1xuICAgICAgICBuZXdFbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCByZWNpcGVbJ2lkJ10pO1xuICAgIH1cbiAgICAvLyBPdmVycmlkZSBhdHRyaWJ1dGVzIGlmIHNwZWNpZmllZFxuICAgIGlmIChyZWNpcGUub3ZlcnJpZGVfYXR0cikge1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiByZWNpcGUub3ZlcnJpZGVfYXR0cikge1xuICAgICAgICAgICAgbmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCBldmFsKHJlY2lwZS5vdmVycmlkZV9hdHRyW2tleV0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBQcm9jZXNzIGNoaWxkcmVuXG4gICAgaWYgKHJlY2lwZS5jaGlsZHJlbiAmJiByZWNpcGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkUmVjaXBlIG9mIHJlY2lwZS5jaGlsZHJlbikge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSBjaGlsZFJlY2lwZS5kaXJlY3RfY2hpbGQgPyBgOnNjb3BlID4gJHtjaGlsZFJlY2lwZS5zZWxlY3Rvcn1gIDogY2hpbGRSZWNpcGUuc2VsZWN0b3I7XG4gICAgICAgICAgICBjb25zdCBjaGlsZEVsZW1lbnRzID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGNoaWxkRWxlbWVudHMuZm9yRWFjaCgoY2hpbGRFbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZSA9IHByb2Nlc3NFbGVtZW50KGNoaWxkRWxlbWVudCwgY2hpbGRSZWNpcGUsIHBhcmVudE5hbWUsIGluZGV4KTtcbiAgICAgICAgICAgICAgICBuZXdFbGVtZW50LmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkUmVjaXBlLmluc2VydF9zcGxpdF9tYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXZlcnkgPSBjaGlsZFJlY2lwZS5pbnNlcnRfc3BsaXRfbWFya2VyX2V2ZXJ5IHx8IDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCAlIGV2ZXJ5ID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwbGl0TWFya2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BsaXQtbWFya2VyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50LmFwcGVuZENoaWxkKHNwbGl0TWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiaW5zZXJ0aW5nIHNwbGl0IG1hcmtlciAxXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjaGlsZFJlY2lwZS5pbnNlcnRfc3BsaXRfbWFya2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiaW5zZXJ0aW5nIHNwbGl0IG1hcmtlciAyXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGxpdE1hcmtlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwbGl0LW1hcmtlcicpO1xuICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50LmFwcGVuZENoaWxkKHNwbGl0TWFya2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm8gc3BsaXQgbWFya2VyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIEhhbmRsZSBlbXB0eSBtZXNzYWdlc1xuICAgIGlmIChyZWNpcGUuZW1wdHlfbWVzc2FnZSAmJiBuZXdFbGVtZW50LmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zdCBlbXB0eVRleHROb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocmVjaXBlLmVtcHR5X21lc3NhZ2UpO1xuICAgICAgICBuZXdFbGVtZW50LmFwcGVuZENoaWxkKGVtcHR5VGV4dE5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG4vLyDlhoXlrrnohJrmnKzkuK3nmoTku6PnoIFcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgKGV2ZW50KSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAvLyDnoa7kv53mtojmga/mnaXoh6rlvZPliY3pobXpnaLvvIzogIzpnZ7lhbbku5ZpZnJhbWXmiJbnqpflj6NcbiAgICBpZiAoZXZlbnQuc291cmNlICE9PSB3aW5kb3cpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAoZXZlbnQuZGF0YS50eXBlICYmIGV2ZW50LmRhdGEudHlwZSA9PT0gJ0NBUFRVUkVfU0NSRUVOU0hPVCcpIHtcbiAgICAgICAgeWllbGQgY2FwdHVyZVNjcmVlbnNob3QoZXZlbnQuZGF0YS50aW1lc3RhbXApO1xuICAgIH1cbiAgICBpZiAoZXZlbnQuZGF0YS50eXBlICYmIGV2ZW50LmRhdGEudHlwZSA9PT0gJ1NBVkVfSU5URVJBQ1RJT05fREFUQScpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIOS9v+eUqCBDaHJvbWUgQVBJIOS/neWtmCBIVE1MIHNuYXBzaG90XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZTEgPSB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoWydodG1sU25hcHNob3RzJ10sIChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBodG1sU25hcHNob3RzID0gcmVzdWx0Lmh0bWxTbmFwc2hvdHMgfHwge307XG4gICAgICAgICAgICAgICAgaHRtbFNuYXBzaG90c1tldmVudC5kYXRhLmRhdGEuaHRtbFNuYXBzaG90SWRdID0gZXZlbnQuZGF0YS5kYXRhLmh0bWxDb250ZW50O1xuICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IGh0bWxTbmFwc2hvdHMgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlMSk7XG4gICAgICAgICAgICBjb25zdCBkYXRhRm9yQmFja2dyb3VuZCA9IE9iamVjdC5hc3NpZ24oe30sIGV2ZW50LmRhdGEuZGF0YSk7XG4gICAgICAgICAgICBkZWxldGUgZGF0YUZvckJhY2tncm91bmQuaHRtbENvbnRlbnQ7XG4gICAgICAgICAgICAvLyDlj5HpgIHmlbDmja7nu5kgYmFja2dyb3VuZCBzY3JpcHRcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlMiA9IHlpZWxkIGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdzYXZlRGF0YScsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YUZvckJhY2tncm91bmRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCFyZXNwb25zZTEuc3VjY2VzcyB8fCAhcmVzcG9uc2UyLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzcG9uc2UxLm1lc3NhZ2UgKyByZXNwb25zZTIubWVzc2FnZSB8fCAnaW50ZXJhY3Rpb24gY2FwdHVyZSBmYWlsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlMik7XG4gICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdJTlRFUkFDVElPTl9DT01QTEVURScsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBldmVudC5kYXRhLmRhdGEudGltZXN0YW1wLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICAgIH0sICcqJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgaW50ZXJhY3Rpb24gZGF0YTonLCBlcnJvcik7XG4gICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdJTlRFUkFDVElPTl9DT01QTEVURScsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBldmVudC5kYXRhLmRhdGEudGltZXN0YW1wXG4gICAgICAgICAgICB9LCAnKicpO1xuICAgICAgICB9XG4gICAgfVxufSkpO1xuZnVuY3Rpb24gY2FwdHVyZVNjcmVlbnNob3QodGltZXN0YW1wKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHNjcmVlbnNob3RJZCA9IGBzY3JlZW5zaG90XyR7dGltZXN0YW1wfWA7XG4gICAgICAgICAgICAvLyDlj5HpgIHmtojmga/liLBiYWNrZ3JvdW5k5bm2562J5b6F5ZON5bqUXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IHlpZWxkIGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdjYXB0dXJlU2NyZWVuc2hvdCcsXG4gICAgICAgICAgICAgICAgc2NyZWVuc2hvdElkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5tZXNzYWdlIHx8ICdTY3JlZW5zaG90IGNhcHR1cmUgZmFpbGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDlnKjmiKrlm77lpITnkIbmiJDlip/lkI7lj5HpgIHmtojmga9cbiAgICAgICAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1NDUkVFTlNIT1RfQ09NUExFVEUnLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgICAgIH0sICcqJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfmjZXojrfmiKrlm77ml7blh7rplJk6JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8g5Y+R6YCB5aSx6LSl5raI5oGvXG4gICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdTQ1JFRU5TSE9UX0NPTVBMRVRFJyxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgICAgICAgICAgfSwgJyonKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuaW1wb3J0IHsgcHJvY2Vzc0VsZW1lbnQgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnQtcHJvY2Vzc29yJztcbmxldCBsYXN0U2Nyb2xsVGltZSA9IDA7IC8vIFRyYWNrIGxhc3Qgc2Nyb2xsIHRpbWVzdGFtcFxuY29uc3QgU0NST0xMX1RIUkVTSE9MRCA9IDE1MDA7IC8vIE1pbmltdW0gdGltZSBpbiBtcyBiZXR3ZWVuIHNjcmVlbnNob3RzIGZvciBzY3JvbGwgYWN0aW9uc1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgIGNvbnNvbGUubG9nKCdET01Db250ZW50TG9hZGVkJyk7XG4gICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgIGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdnZXRSZWNpcGUnLFxuICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICB9LCByZXNvbHZlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZXNwb25zZScpO1xuICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UucmVjaXBlKSB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGUgPSByZXNwb25zZS5yZWNpcGU7XG4gICAgICAgICAgICBjb25zdCByb290RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocmVjaXBlLnNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmIChyb290RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1Jvb3QgPSBwcm9jZXNzRWxlbWVudChyb290RWxlbWVudCwgcmVjaXBlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhuZXdSb290Lm91dGVySFRNTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBjbGlja2FibGUgZWxlbWVudHM6JywgZXJyb3IpO1xuICAgIH1cbn0pKTtcbmZ1bmN0aW9uIGdlbmVyYXRlSHRtbFNuYXBzaG90SWQoKSB7XG4gICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIHJldHVybiBgaHRtbF8ke2hhc2hDb2RlKHVybCl9XyR7dGltZXN0YW1wfWA7XG59XG5mdW5jdGlvbiBoYXNoQ29kZShzdHIpIHtcbiAgICBsZXQgaGFzaCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpICsgc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGhhc2ggfD0gMDtcbiAgICB9XG4gICAgY29uc29sZS5sb2coXCJIYXNoIHZhbHVlIGJlZm9yZSByZXR1cm46XCIsIGhhc2gpO1xuICAgIHJldHVybiBoYXNoLnRvU3RyaW5nKCk7XG59XG4vLyBGdW5jdGlvbiB0byBnZXQgY2xpY2thYmxlIGVsZW1lbnRzIGluIHRoZSB2aWV3cG9ydFxuZnVuY3Rpb24gZ2V0Q2xpY2thYmxlRWxlbWVudHNJblZpZXdwb3J0KCkge1xuICAgIGNvbnN0IGNsaWNrYWJsZUVsZW1lbnRzID0gW107IC8vIEFycmF5IHRvIHN0b3JlIGNsaWNrYWJsZSBlbGVtZW50c1xuICAgIC8vIFNlbGVjdCBhbGwgcG90ZW50aWFsIGNsaWNrYWJsZSBlbGVtZW50c1xuICAgIGNvbnN0IGFsbEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYSwgYnV0dG9uLCBbb25jbGlja10sIGlucHV0W3R5cGU9XCJidXR0b25cIl0sIGlucHV0W3R5cGU9XCJzdWJtaXRcIl0nKTtcbiAgICAvLyBDaGVjayBpZiBlYWNoIGVsZW1lbnQgaXMgaW4gdGhlIHZpZXdwb3J0XG4gICAgYWxsRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgaWYgKHJlY3QudG9wID49IDAgJiZcbiAgICAgICAgICAgIHJlY3QubGVmdCA+PSAwICYmXG4gICAgICAgICAgICByZWN0LmJvdHRvbSA8PSAod2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpICYmXG4gICAgICAgICAgICByZWN0LnJpZ2h0IDw9ICh3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpKSB7XG4gICAgICAgICAgICBjbGlja2FibGVFbGVtZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0YWdOYW1lOiBlbGVtZW50LnRhZ05hbWUsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBlbGVtZW50LmNsYXNzTmFtZSxcbiAgICAgICAgICAgICAgICBpZDogZWxlbWVudC5pZCxcbiAgICAgICAgICAgICAgICBpbm5lclRleHQ6IGVsZW1lbnQuaW5uZXJUZXh0LnRyaW0oKSxcbiAgICAgICAgICAgICAgICBvdXRlckhUTUw6IGVsZW1lbnQub3V0ZXJIVE1MLnRyaW0oKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGNsaWNrYWJsZUVsZW1lbnRzO1xufVxuLy8gRnVuY3Rpb24gdG8gY2FwdHVyZSBpbnRlcmFjdGlvbnNcbmZ1bmN0aW9uIGNhcHR1cmVJbnRlcmFjdGlvbihldmVudFR5cGUsIHRhcmdldCwgdGltZXN0YW1wLCBzZWxlY3RvciwgY2xpY2thYmxlSWQsIHVybCkge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBuZXcgSFRNTCBzbmFwc2hvdCBJRFxuICAgICAgICAgICAgY29uc3QgY3VycmVudFNuYXBzaG90SWQgPSBnZW5lcmF0ZUh0bWxTbmFwc2hvdElkKCk7XG4gICAgICAgICAgICAvLyBTYXZlIEhUTUwgc25hcHNob3QgYW5kIHdhaXQgZm9yIGl0IHRvIGNvbXBsZXRlXG4gICAgICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFsnaHRtbFNuYXBzaG90cyddLCAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGh0bWxTbmFwc2hvdHMgPSByZXN1bHQuaHRtbFNuYXBzaG90cyB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgaHRtbFNuYXBzaG90c1tjdXJyZW50U25hcHNob3RJZF0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub3V0ZXJIVE1MO1xuICAgICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBodG1sU25hcHNob3RzIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoY2hyb21lLnJ1bnRpbWUubGFzdEVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodm9pZCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNvbnN0IGNsaWNrYWJsZUVsZW1lbnRzID0gZ2V0Q2xpY2thYmxlRWxlbWVudHNJblZpZXdwb3J0KCk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgICAgICAgICB0YXJnZXRPdXRlckhUTUw6IHRhcmdldC5vdXRlckhUTUwsXG4gICAgICAgICAgICAgICAgdGFyZ2V0Q2xhc3M6IHRhcmdldC5jbGFzc05hbWUsXG4gICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IHRhcmdldC5pZCxcbiAgICAgICAgICAgICAgICB0YXJnZXRUZXh0OiB0YXJnZXQuaW5uZXJUZXh0IHx8IHRhcmdldC52YWx1ZSB8fCAnJyxcbiAgICAgICAgICAgICAgICBodG1sU25hcHNob3RJZDogY3VycmVudFNuYXBzaG90SWQsXG4gICAgICAgICAgICAgICAgLy8gY2xpY2thYmxlRWxlbWVudHM6IGNsaWNrYWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBzZWxlY3RvciB8fCAnJyxcbiAgICAgICAgICAgICAgICBjbGlja2FibGVJZDogY2xpY2thYmxlSWQgfHwgJycsXG4gICAgICAgICAgICAgICAgdXJsOiB1cmwgfHwgJycsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgeWllbGQgY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoeyBhY3Rpb246ICdzYXZlRGF0YScsIGRhdGEgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkdXJpbmcgJHtldmVudFR5cGV9IGV2ZW50IGhhbmRsaW5nOmAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuLy8gQ2FwdHVyZSBzY3JvbGwgaW50ZXJhY3Rpb25zXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoZXZlbnQpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKGN1cnJlbnRUaW1lIC0gbGFzdFNjcm9sbFRpbWUgPj0gU0NST0xMX1RIUkVTSE9MRCkge1xuICAgICAgICAgICAgbGFzdFNjcm9sbFRpbWUgPSBjdXJyZW50VGltZTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgIHlpZWxkIGNhcHR1cmVJbnRlcmFjdGlvbignc2Nyb2xsJywgZXZlbnQudGFyZ2V0LCB0aW1lc3RhbXAsICcnLCAnJywgJycpO1xuICAgICAgICAgICAgeWllbGQgY2FwdHVyZVNjcmVlbnNob3QodGltZXN0YW1wKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIHNjcm9sbCBldmVudCBoYW5kbGluZzonLCBlcnJvcik7XG4gICAgfVxufSkpO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgKGV2ZW50KSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgaWYgKHRhcmdldCAmJlxuICAgICAgICAoKHRhcmdldC50YWdOYW1lID09PSBcIklOUFVUXCIgJiYgdGFyZ2V0LnR5cGUgPT09IFwidGV4dFwiKSB8fFxuICAgICAgICAgICAgdGFyZ2V0LnRhZ05hbWUgPT09IFwiVEVYVEFSRUFcIikpIHtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgICB5aWVsZCBjYXB0dXJlU2NyZWVuc2hvdCh0aW1lc3RhbXApO1xuICAgICAgICB5aWVsZCBjYXB0dXJlSW50ZXJhY3Rpb24oXCJpbnB1dFwiLCB0YXJnZXQsIHRpbWVzdGFtcCwgJycsICcnLCAnJyk7XG4gICAgfVxufSksIHRydWUpO1xuLy8gQ2FwdHVyZSBjbGljayBpbnRlcmFjdGlvbnNcbmZ1bmN0aW9uIGdldFVuaXF1ZVNlbGVjdG9yKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5pZCkge1xuICAgICAgICByZXR1cm4gYCMke2VsZW1lbnQuaWR9YDtcbiAgICB9XG4gICAgaWYgKGVsZW1lbnQuY2xhc3NOYW1lKSB7XG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lLnRyaW0oKS5zcGxpdCgvXFxzKy8pLmpvaW4oJy4nKTtcbiAgICAgICAgcmV0dXJuIGAke2VsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpfS4ke2NsYXNzTmFtZX1gO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG59XG5mdW5jdGlvbiBnZXRGdWxsU2VsZWN0b3IoZWxlbWVudCkge1xuICAgIGxldCBwYXRoID0gW107XG4gICAgd2hpbGUgKGVsZW1lbnQucGFyZW50RWxlbWVudCkge1xuICAgICAgICBwYXRoLnVuc2hpZnQoZ2V0VW5pcXVlU2VsZWN0b3IoZWxlbWVudCkpO1xuICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgIH1cbiAgICByZXR1cm4gcGF0aC5qb2luKCcgPiAnKTtcbn1cbi8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4vLyAgICAgdHJ5IHtcbi8vICAgICAgICAgZnVuY3Rpb24gZmluZENsaWNrYWJsZVBhcmVudChlbGVtZW50OiBIVE1MRWxlbWVudCB8IG51bGwsIGRlcHRoOiBudW1iZXIgPSAwKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcbi8vICAgICAgICAgICAgIGlmICghZWxlbWVudCB8fCBkZXB0aD49MikgcmV0dXJuIG51bGw7XG4vLyAgICAgICAgICAgICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2RhdGEtY2xpY2thYmxlLWlkJykpIHtcbi8vICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgIHJldHVybiBmaW5kQ2xpY2thYmxlUGFyZW50KGVsZW1lbnQucGFyZW50RWxlbWVudCxkZXB0aCsxKTtcbi8vICAgICAgICAgfVxuLy8gICAgICAgICBjb25zdCBjbGlja2FibGVFbGVtZW50ID0gZmluZENsaWNrYWJsZVBhcmVudChldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnQpO1xuLy8gICAgICAgICBjb25zdCBjbGlja2FibGVJZCA9IGNsaWNrYWJsZUVsZW1lbnQgPyBjbGlja2FibGVFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1jbGlja2FibGUtaWQnKSB8fCAnJyA6ICcnO1xuLy8gICAgICAgICBjb25zb2xlLmxvZygnY2xpY2snKVxuLy8gICAgICAgICBjb25zdCB0aW1lc3RhbXA9bmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuLy8gICAgICAgICBjb25zb2xlLmxvZyh0aW1lc3RhbXApXG4vLyAgICAgICAgIGNvbnN0IHNlbGVjdG9yPWdldEZ1bGxTZWxlY3RvcihldmVudC50YXJnZXQpO1xuLy8gICAgICAgICBjb25zb2xlLmxvZygnc3JhcnQgc2NyZWVuc2hvdCcpXG4vLyAgICAgICAgIGNhcHR1cmVTY3JlZW5zaG90KHRpbWVzdGFtcCk7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCdlbmQgc2NyZWVuc2hvdCcpXG4vLyAgICAgICAgIGNhcHR1cmVJbnRlcmFjdGlvbignY2xpY2snLCBldmVudC50YXJnZXQsdGltZXN0YW1wLHNlbGVjdG9yLGNsaWNrYWJsZUlkLCcnKTtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ2VuZCcpXG4vLyAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbi8vICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIGNsaWNrIGV2ZW50IGhhbmRsaW5nOicsIGVycm9yKTtcbi8vICAgICB9XG4vLyB9KTtcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgICAvLyBIYW5kbGUgYWxsIHR5cGVzIG9mIG9yZGVyIGJ1dHRvbnNcbiAgICBjb25zdCBwbGFjZU9yZGVyQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2lkPVwicGxhY2VPcmRlclwiXSwgaW5wdXRbaWQ9XCJ0dXJiby1jaGVja291dC1weW8tYnV0dG9uXCJdJyk7XG4gICAgY29uc3QgYnV5Tm93QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbaWQ9XCJidXktbm93LWJ1dHRvblwiXScpO1xuICAgIGNvbnN0IHNldHVwTm93QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uW2lkPVwicmN4LXN1YnNjcmliZS1zdWJtaXQtYnV0dG9uLWFubm91bmNlXCJdJyk7XG4gICAgY29uc3QgcHJvY2VlZFRvQ2hlY2tvdXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwicHJvY2VlZFRvUmV0YWlsQ2hlY2tvdXRcIl0nKTtcbiAgICAvLyBIYW5kbGUgQnV5IE5vdyBhbmQgU2V0IFVwIE5vdyBidXR0b25zIGlmIHByZXNlbnRcbiAgICBbYnV5Tm93QnV0dG9uLCBzZXR1cE5vd0J1dHRvbl0uZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICBpZiAoYnV0dG9uKSB7XG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2U7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdEluZm8gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogKChfYiA9IChfYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGl0bGVcIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbm5lclRleHQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi50cmltKCkpIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmljZTogKChfZCA9IChfYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJzcGFuLmEtcHJpY2UuYW9rLWFsaWduLWNlbnRlci5yZWludmVudFByaWNlUHJpY2VUb1BheU1hcmdpbi5wcmljZVRvUGF5XCIpKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuaW5uZXJUZXh0KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QudHJpbSgpKSB8fCBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNpbjogKChfZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dCNBU0lOXCIpKSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UudmFsdWUpIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7fVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYWxsIG9wdGlvbiBzZWxlY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvblJvd3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjdHdpc3RlciBkaXYuYS1yb3c6aGFzKGxhYmVsLmEtZm9ybS1sYWJlbCk6aGFzKHNwYW4uc2VsZWN0aW9uKVwiKSk7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvblJvd3MuZm9yRWFjaChyb3cgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsYWJlbCA9ICgoX2IgPSAoX2EgPSByb3cucXVlcnlTZWxlY3RvcihcImxhYmVsLmEtZm9ybS1sYWJlbFwiKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlubmVyVGV4dCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnJlcGxhY2UoXCI6IFwiLCBcIlwiKSkgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gKChfYyA9IHJvdy5xdWVyeVNlbGVjdG9yKFwic3Bhbi5zZWxlY3Rpb25cIikpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5pbm5lclRleHQpIHx8IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFiZWwgJiYgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5vcHRpb25zW2xhYmVsXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCR7YnV0dG9uLmlkfSBjbGlja2VkIC0gUHJvZHVjdCBJbmZvOmAsIHByb2R1Y3RJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHByb2R1Y3QgaW5mb1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0geWllbGQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KHsgb3JkZXJEZXRhaWxzOiBbXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JkZXJEZXRhaWxzID0gcmVzdWx0Lm9yZGVyRGV0YWlscyB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJEZXRhaWxzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvZHVjdEluZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmljZTogcGFyc2VGbG9hdChwcm9kdWN0SW5mby5wcmljZS5yZXBsYWNlKC9bXjAtOS5dL2csICcnKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBhc2luOiBwcm9kdWN0SW5mby5hc2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogcHJvZHVjdEluZm8ub3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgb3JkZXJEZXRhaWxzIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgY2FwdHVyaW5nICR7YnV0dG9uLmlkfSBwcm9kdWN0IGluZm86YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChwcm9jZWVkVG9DaGVja291dEJ1dHRvbikge1xuICAgICAgICBwcm9jZWVkVG9DaGVja291dEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHZhciBfYSwgX2IsIF9jO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZEl0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgY29uc3QgY2FydEl0ZW1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbaWRePVwic2MtYWN0aXZlLVwiXScpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5pZCAhPT0gJ3NjLWFjdGl2ZS1jYXJ0Jyk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGNhcnRJdGVtcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGVja2JveCA9IGl0ZW0ucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja2JveCAmJiBjaGVja2JveC5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9kdWN0TGluayA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLnNjLWl0ZW0tcHJvZHVjdC10aXRsZS1jb250IC5zYy1wcm9kdWN0LWxpbmsnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0TGluaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGxOYW1lRWxlbWVudCA9IHByb2R1Y3RMaW5rLnF1ZXJ5U2VsZWN0b3IoJy5hLXRydW5jYXRlLWZ1bGwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gKChfYSA9IGZ1bGxOYW1lRWxlbWVudCA9PT0gbnVsbCB8fCBmdWxsTmFtZUVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGZ1bGxOYW1lRWxlbWVudC50ZXh0Q29udGVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRyaW0oKSkgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaHJlZiA9IHByb2R1Y3RMaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpIHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzaW4gPSAoKF9iID0gaHJlZi5tYXRjaCgvcHJvZHVjdFxcLyhbQS1aMC05XXsxMH0pLykpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYlsxXSkgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpY2VFbGVtZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcuc2MtaXRlbS1wcmljZS1ibG9jayAuYS1vZmZzY3JlZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmljZSA9IHByaWNlRWxlbWVudCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoKChfYyA9IHByaWNlRWxlbWVudC50ZXh0Q29udGVudCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnJlcGxhY2UoL1teMC05Ll0vZywgJycpKSB8fCAnMCcpIDogMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFyaWF0aW9uRWxlbWVudHMgPSBpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zYy1wcm9kdWN0LXZhcmlhdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhdGlvbkVsZW1lbnRzLmZvckVhY2godmFyaWF0aW9uID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsYWJlbCA9ICgoX2IgPSAoX2EgPSB2YXJpYXRpb24ucXVlcnlTZWxlY3RvcignLmEtdGV4dC1ib2xkJykpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50ZXh0Q29udGVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnRyaW0oKS5yZXBsYWNlKCc6JywgJycpKSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSAoKF9kID0gKF9jID0gdmFyaWF0aW9uLnF1ZXJ5U2VsZWN0b3IoJy5hLXNpemUtc21hbGw6bm90KC5hLXRleHQtYm9sZCknKSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnRleHRDb250ZW50KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QudHJpbSgpKSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhYmVsICYmIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zW2xhYmVsXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoeyBvcmRlckRldGFpbHM6IFtdIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcmRlckRldGFpbHMgPSByZXN1bHQub3JkZXJEZXRhaWxzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkT3JkZXJEZXRhaWxzID0gb3JkZXJEZXRhaWxzLmNvbmNhdChzZWxlY3RlZEl0ZW1zKTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgb3JkZXJEZXRhaWxzOiB1cGRhdGVkT3JkZXJEZXRhaWxzIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3RvcmVkIHNlbGVjdGVkIGNhcnQgaXRlbXM6Jywgc2VsZWN0ZWRJdGVtcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FwdHVyaW5nIHNlbGVjdGVkIGNhcnQgaXRlbXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxufSk7XG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnZ2V0SFRNTCcpIHtcbiAgICAgICAgY29uc3QgaHRtbENvbnRlbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub3V0ZXJIVE1MO1xuICAgICAgICBzZW5kUmVzcG9uc2UoeyBodG1sOiBodG1sQ29udGVudCB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59KTtcbiJdLCJuYW1lcyI6WyJwcm9jZXNzRWxlbWVudCIsImVsZW1lbnQiLCJyZWNpcGUiLCJwYXJlbnROYW1lIiwibnRoQ2hpbGQiLCJ0YWdOYW1lIiwidGFnX25hbWUiLCJ0b0xvd2VyQ2FzZSIsImVuZHNXaXRoIiwic2xpY2UiLCJuZXdFbGVtZW50IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZWxlbWVudFRleHQiLCJ0ZXh0X3NlbGVjdG9yIiwidGV4dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJUZXh0IiwidGV4dENvbnRlbnQiLCJ0ZXh0X2pzIiwiZXZhbCIsImFkZF90ZXh0IiwicmVwbGFjZSIsInRyaW0iLCJ0ZXh0X2Zvcm1hdCIsImVsZW1lbnROYW1lIiwibmFtZSIsInRvU3RyaW5nIiwic2V0QXR0cmlidXRlIiwiY2xpY2thYmxlIiwiRXJyb3IiLCJjbGlja19lbGVtZW50IiwiY2xpY2tfc2VsZWN0b3IiLCJjb25zb2xlIiwibG9nIiwid2luZG93IiwiY2xpY2thYmxlX3JlY2lwZXMiLCJpbnB1dFR5cGUiLCJnZXRBdHRyaWJ1dGUiLCJpbmNsdWRlcyIsInZhbHVlIiwiY2hlY2tlZCIsImlucHV0X3JlY2lwZXMiLCJvcHRpb25zIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJvcHRpb24iLCJvcHRpb25WYWx1ZSIsIm9wdGlvbk5hbWUiLCJuZXdPcHRpb24iLCJzZWxlY3RlZCIsImFwcGVuZENoaWxkIiwiYXR0cnNUb0NvcHkiLCJhdHRyIiwia2VlcF9hdHRyIiwia2V5Iiwib3ZlcnJpZGVfYXR0ciIsImNoaWxkcmVuIiwibGVuZ3RoIiwiY2hpbGRSZWNpcGUiLCJzZWxlY3RvciIsImRpcmVjdF9jaGlsZCIsImNoaWxkRWxlbWVudHMiLCJjaGlsZEVsZW1lbnQiLCJpbmRleCIsImNoaWxkTm9kZSIsImluc2VydF9zcGxpdF9tYXJrZXIiLCJpbnNlcnRfc3BsaXRfbWFya2VyX2V2ZXJ5Iiwic3BsaXRNYXJrZXIiLCJlbXB0eV9tZXNzYWdlIiwiZW1wdHlUZXh0Tm9kZSIsImNyZWF0ZVRleHROb2RlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJjYXB0dXJlU2NyZWVuc2hvdCIsInRpbWVzdGFtcCIsInRoaXMiLCJzY3JlZW5zaG90SWQiLCJyZXNwb25zZSIsImNocm9tZSIsInJ1bnRpbWUiLCJzZW5kTWVzc2FnZSIsImFjdGlvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwicG9zdE1lc3NhZ2UiLCJ0eXBlIiwiZXJyb3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJzb3VyY2UiLCJkYXRhIiwicmVzcG9uc2UxIiwic3RvcmFnZSIsImxvY2FsIiwiaHRtbFNuYXBzaG90cyIsImh0bWxTbmFwc2hvdElkIiwiaHRtbENvbnRlbnQiLCJzZXQiLCJkYXRhRm9yQmFja2dyb3VuZCIsImFzc2lnbiIsInJlc3BvbnNlMiIsImxhc3RTY3JvbGxUaW1lIiwiU0NST0xMX1RIUkVTSE9MRCIsImdlbmVyYXRlSHRtbFNuYXBzaG90SWQiLCJ1cmwiLCJsb2NhdGlvbiIsImhyZWYiLCJEYXRlIiwidG9JU09TdHJpbmciLCJoYXNoQ29kZSIsInN0ciIsImhhc2giLCJpIiwiY2hhckNvZGVBdCIsImdldENsaWNrYWJsZUVsZW1lbnRzSW5WaWV3cG9ydCIsImNsaWNrYWJsZUVsZW1lbnRzIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsImxlZnQiLCJib3R0b20iLCJpbm5lckhlaWdodCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInJpZ2h0IiwiaW5uZXJXaWR0aCIsImNsaWVudFdpZHRoIiwicHVzaCIsImNsYXNzTmFtZSIsImlkIiwib3V0ZXJIVE1MIiwiY2FwdHVyZUludGVyYWN0aW9uIiwiZXZlbnRUeXBlIiwidGFyZ2V0IiwiY2xpY2thYmxlSWQiLCJjdXJyZW50U25hcHNob3RJZCIsImxhc3RFcnJvciIsInRhcmdldE91dGVySFRNTCIsInRhcmdldENsYXNzIiwidGFyZ2V0SWQiLCJ0YXJnZXRUZXh0IiwiZ2V0VW5pcXVlU2VsZWN0b3IiLCJzcGxpdCIsImpvaW4iLCJnZXRGdWxsU2VsZWN0b3IiLCJwYXRoIiwicGFyZW50RWxlbWVudCIsInVuc2hpZnQiLCJyb290RWxlbWVudCIsIm5ld1Jvb3QiLCJjdXJyZW50VGltZSIsIm5vdyIsImJ1eU5vd0J1dHRvbiIsInNldHVwTm93QnV0dG9uIiwicHJvY2VlZFRvQ2hlY2tvdXRCdXR0b24iLCJidXR0b24iLCJfYSIsIl9iIiwiX2MiLCJfZCIsIl9lIiwicHJvZHVjdEluZm8iLCJ0aXRsZSIsInByaWNlIiwiYXNpbiIsIkFycmF5IiwiZnJvbSIsInJvdyIsImxhYmVsIiwib3JkZXJEZXRhaWxzIiwicGFyc2VGbG9hdCIsInNlbGVjdGVkSXRlbXMiLCJjYXJ0SXRlbXMiLCJmaWx0ZXIiLCJpdGVtIiwiY2hlY2tib3giLCJwcm9kdWN0TGluayIsImZ1bGxOYW1lRWxlbWVudCIsIm1hdGNoIiwicHJpY2VFbGVtZW50IiwidmFyaWF0aW9uIiwidXBkYXRlZE9yZGVyRGV0YWlscyIsImNvbmNhdCIsIm9uTWVzc2FnZSIsImFkZExpc3RlbmVyIiwic2VuZGVyIiwic2VuZFJlc3BvbnNlIiwiaHRtbCJdLCJzb3VyY2VSb290IjoiIn0=