(()=>{"use strict";const e={selector:"#nav-search-bar-form",children:[{selector:"input#twotabsearchtextbox",name:"search_input"},{selector:"#nav-search-submit-button",clickable:!0,name:"search_button"}]},t=[{match:"/",match_method:"url",selector:"html",children:[{selector:"head",children:[{selector:"title",add_text:!0}]},{selector:"body",children:[e]}]},{match:"/s",match_method:"url",selector:"html",children:[{selector:"head",children:[{selector:"title",add_text:!0}]},{selector:"body",children:[e,{selector:"#s-refinements",name:"refinements",children:[{selector:"div.a-section.a-spacing-none:not(:has(#n-title)):has(span.a-size-base.a-color-base.puis-bold-weight-text):has(ul span.a-declarative > span > li):not(#reviewsRefinements):not(#departments):not(#priceRefinements):not(#filters)",name:"from_text",text_selector:"span.a-size-base.a-color-base.puis-bold-weight-text",children:[{selector:"span.a-size-base.a-color-base.puis-bold-weight-text",add_text:!0,class:"refinement-title"},{selector:"ul:nth-of-type(1) > span.a-declarative > span > li",add_text:!0,name:"from_text",clickable:!0,click_selector:"a",direct_child:!0,children:[{selector:"input[type='checkbox']"}]}]},{selector:"#departments",name:"departments",children:[{selector:"li a",add_text:!0,name:"from_text",clickable:!0}]},{selector:"#reviewsRefinements",name:"reviews_refinements",children:[{selector:"li a",add_text:!0,name:"from_text",clickable:!0}]}]},{selector:"div.s-main-slot.s-result-list.s-search-results",name:"search_results",children:[{insert_split_marker:!0,insert_split_marker_every:4,selector:'div[data-component-type="s-search-result"]',text_selector:"span.a-size-base-plus.a-color-base.a-text-normal",name:"from_text",class:"search-result",children:[{selector:"div[data-cy='title-recipe'] a",add_text:!0,class:"product-name",clickable:!0,name:"view_product"},{selector:"div[data-cy='reviews-block']",class:"product-review",children:[{selector:"span.a-icon-alt",add_text:!0,class:"product-rating"},{selector:"span.a-size-base.s-underline-text",add_text:!0,text_format:"{} reviews",class:"product-rating-count"}]},{selector:"div[data-cy='price-recipe']",class:"product-price",children:[{selector:"a.a-link-normal > span.a-price > span.a-offscreen",add_text:!0}]},{selector:"div[data-cy='delivery-recipe']",add_text:!0,class:"product-delivery"}]}]},{selector:"span.s-pagination-strip",name:"pagination",children:[{selector:".s-pagination-item",add_text:!0,name:"from_text",clickable:!0}]}]}]},{match:"#productTitle",match_text:"",selector:"html",terminate:"return !!arguments[0]",terminate_callback:"return arguments[0]",children:[{selector:"head",children:[{selector:"title",add_text:!0}]},{selector:"body",children:[e,{selector:"#centerCol",class:"product-card",children:[{selector:"#title",add_text:!0,keep_attr:["id"]},{selector:"#averageCustomerReviews",class:"review",children:[{selector:"span.a-icon-alt",add_text:!0},{selector:"#acrCustomerReviewText",add_text:!0}]},{selector:"#apex_desktop_newAccordionRow #corePriceDisplay_desktop_feature_div span.a-price.aok-align-center.reinventPricePriceToPayMargin.priceToPay",add_text:!0,text_format:"Price: {}",class:"product-price"},{selector:"#twister",class:"product-options",children:[{selector:"div.a-row:has(label.a-form-label):has(span.selection)",children:[{selector:"label.a-form-label",add_text:!0},{selector:"span.selection",add_text:!0}]}]}]},{selector:"#addToCart:has(#buy-now-button)",name:"add_to_cart",children:[{selector:"#productFactsDesktopExpander",add_text:!0,class:"product-facts"},{selector:"div.mir-layout-DELIVERY_BLOCK-slot-PRIMARY_DELIVERY_MESSAGE_LARGE",add_text:!0,class:"product-delivery"},{selector:"#buy-now-button",add_text:!0,clickable:!0,name:"buy_now",class:"product-buy-now",before_hook:'\nconst title = document.querySelector("#title").innerText\nconst price = document.querySelector("span.a-price.aok-align-center.reinventPricePriceToPayMargin.priceToPay").innerText\nconst options = Array.from(document.querySelectorAll("#twister div.a-row:has(label.a-form-label):has(span.selection)")).map(a => ({label: a.querySelector("label.a-form-label").innerText, value: a.querySelector("span.selection").innerText}))\nconst options_dict = {}\nfor (const option of options) {\n    options_dict[option["label"].replace(": ", "")] = option["value"]\n}\nconst asin = document.querySelector("input#ASIN").value\nconsole.log({title, price, options: options_dict, asin})\nreturn {title, price, options: options_dict, asin}\n'}]}]}]},{match:"/ap/signin",match_method:"url",terminate:"return !!arguments[0]",terminate_callback:"return arguments[0]",selector:"html"}];var o=function(e,t,o,r){return new(o||(o=Promise))((function(a,c){function s(e){try{l(r.next(e))}catch(e){c(e)}}function n(e){try{l(r.throw(e))}catch(e){c(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,n)}l((r=r.apply(e,t||[])).next())}))};let r=[],a=[],c=0;chrome.runtime.onMessage.addListener(((e,t,s)=>(o(void 0,void 0,void 0,(function*(){try{if("saveData"===e.action){if(console.log("saveData ",e.data.eventType),c++,e.data.actionSequenceId=c,r.push(e.data),r.length>10){let e=yield chrome.storage.local.get({interactions:[]});e=e.interactions||[];let t=e.concat(r);r.length=0,yield chrome.storage.local.set({interactions:t})}s({success:!0})}if("captureScreenshot"===e.action){const t=yield function(){return o(this,void 0,void 0,(function*(){try{const[e]=yield chrome.tabs.query({active:!0,currentWindow:!0});if(e)return yield chrome.tabs.captureVisibleTab(e.windowId,{format:"jpeg",quality:25})}catch(e){console.error("Error capturing screenshot:",e)}return null}))}();if(t){if(a.push([t,e.screenshotId]),a.length>10){let e=yield chrome.storage.local.get({screenshots:[]});e=e.screenshots||[];const t=e.concat(a);a.length=0,yield chrome.storage.local.set({screenshots:t})}s({success:!0})}else s({success:!1,message:"Failed to capture screenshot"})}if("downloadData"===e.action){const t=(new Date).toISOString().replace(/[:.]/g,"-"),c=`DATA/SESSION_${t}`;chrome.downloads.download({url:"data:text/plain;charset=utf-8,"+encodeURIComponent(`Session data for timestamp: ${t}, user id: ${e.userId}`),filename:`${c}/session_info.txt`,saveAs:!1},(e=>o(void 0,void 0,void 0,(function*(){let e=(yield chrome.storage.local.get({htmlSnapshots:[]})).htmlSnapshots||{};chrome.storage.local.remove("htmlSnapshots"),console.log(e);const t=yield chrome.storage.local.get({interactions:[]});chrome.storage.local.remove("interactions");let o=t.interactions||[];console.log(o),o=o.concat(r),r.length=0;let n=(yield chrome.storage.local.get({orderDetails:[]})).orderDetails||[];chrome.storage.local.remove("orderDetails");const l={htmlSnapshots:e,interactions:o,orderDetails:n},i=JSON.stringify(l,null,2);chrome.downloads.download({url:"data:text/json;charset=utf-8,"+encodeURIComponent(i),filename:`${c}/interactions.json`,saveAs:!1});const d=yield chrome.storage.local.get({screenshots:[]});chrome.storage.local.remove("screenshots");let h=d.screenshots||[];h=h.concat(a),console.log(h),a.length=0,h.forEach(((e,t)=>{console.log(e);const o=`${c}/${e[1].replace(/[:.]/g,"-")}.jpg`;chrome.downloads.download({url:e[0],filename:o,saveAs:!1})})),s({success:!0})}))))}"clearMemoryCache"===e.action&&(r=[],a=[],c=0,s({success:!0}))}catch(e){console.error("Error handling message:",e),s({success:!1,error:e.message})}})),!0))),chrome.tabs.onActivated.addListener((e=>o(void 0,void 0,void 0,(function*(){try{const t=e.tabId,s=yield chrome.tabs.get(t);if(!s)return void console.error(`Failed to get tab with ID: ${t}`);if(console.log(`Switched to tab ${t} with URL: ${s.url}`),s.url&&s.url.includes("amazon.com")){const e=(new Date).toISOString(),n=`html_${function(e){let t=0;for(let o=0;o<e.length;o++)t=(t<<5)-t+e.charCodeAt(o),t|=0;return console.log("Hash value before return:",t),t.toString()}(s.url)}_${e}`;chrome.tabs.sendMessage(t,{action:"getHTML"},(t=>o(void 0,void 0,void 0,(function*(){const o=null==t?void 0:t.html,l=(yield chrome.storage.local.get({htmlSnapshots:{}})).htmlSnapshots||{};l[n]=o,yield chrome.storage.local.set({htmlSnapshots:l}),c++;const i={actionSequenceId:c,eventType:"tabActivate",timestamp:e,target_url:s.url,htmlSnapshotId:n};if(r.push(i),r.length>10){let e=yield chrome.storage.local.get({interactions:[]});e=e.interactions||[];let t=e.concat(r);r.length=0,yield chrome.storage.local.set({interactions:t})}const d=yield chrome.tabs.captureVisibleTab(s.windowId,{format:"jpeg",quality:25}),h=`screenshot_${e}`;if(d&&(a.push([d,h]),a.length>10)){let e=yield chrome.storage.local.get({screenshots:[]});e=e.screenshots||[];const t=e.concat(a);a.length=0,yield chrome.storage.local.set({screenshots:t})}}))))}}catch(e){console.error("Error in tab activate handler:",e)}})))),chrome.runtime.onMessage.addListener(((e,r,a)=>{var c;if("getRecipe"===e.action&&(null===(c=r.tab)||void 0===c?void 0:c.id))return function(e,r){return o(this,void 0,void 0,(function*(){const o=new URL(r).pathname;for(const r of t){const t=r.match_method||"text";if("text"===t)try{const[{result:t}]=yield chrome.scripting.executeScript({target:{tabId:e},func:(e,t)=>{var o,r;const a=document.querySelector(e);return a&&(!t||null!==(r=null===(o=a.textContent)||void 0===o?void 0:o.toLowerCase().includes(t.toLowerCase()))&&void 0!==r&&r)},args:[r.match,r.match_text||""]});if(t)return r}catch(e){console.error("Error checking text match:",e)}else if("url"===t&&r.match===o)return r}throw new Error(`No matching recipe found for path: ${o}`)}))}(r.tab.id,e.url).then((e=>{a({recipe:e})})).catch((e=>{a({error:e.message})})),!0}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFDQSxPQUFPSCxDQUVmLENBQ0EsTUFBT3BELEdBQ0h4QixRQUFRd0IsTUFBTSw2QkFBOEJBLEVBQ2hELE1BRUMsR0FBb0IsUUFBaEJxRCxHQUF5QkQsRUFBT2lCLFFBQVVwQixFQUMvQyxPQUFPRyxDQUVmLENBQ0EsTUFBTSxJQUFJbUIsTUFBTSxzQ0FBc0N0QixJQUMxRCxHQUNKLENBSVF1QixDQUFhbkcsRUFBT2tCLElBQUl5RCxHQUFJNUUsRUFBUXVDLEtBQy9CaEQsTUFBTXlGLElBQ1A5RSxFQUFhLENBQUU4RSxPQUFRQSxHQUFTLElBRS9CcUIsT0FBT3pFLElBQ1IxQixFQUFhLENBQUUwQixNQUFPQSxFQUFNNUIsU0FBVSxLQUVuQyxDQUNYLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL3NyYy9yZWNpcGUudHMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvYmFja2dyb3VuZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgbmF2ID0ge1xuICAgIFwic2VsZWN0b3JcIjogXCIjbmF2LXNlYXJjaC1iYXItZm9ybVwiLFxuICAgIFwiY2hpbGRyZW5cIjogW1xuICAgICAgICB7XG4gICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiaW5wdXQjdHdvdGFic2VhcmNodGV4dGJveFwiLFxuICAgICAgICAgICAgXCJuYW1lXCI6IFwic2VhcmNoX2lucHV0XCIsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCIjbmF2LXNlYXJjaC1zdWJtaXQtYnV0dG9uXCIsXG4gICAgICAgICAgICBcImNsaWNrYWJsZVwiOiB0cnVlLFxuICAgICAgICAgICAgXCJuYW1lXCI6IFwic2VhcmNoX2J1dHRvblwiLFxuICAgICAgICB9LFxuICAgIF0sXG59O1xuZXhwb3J0IGNvbnN0IHJlZmluZW1lbnRfb3B0aW9uID0gW1xuICAgIHtcbiAgICAgICAgXCJzZWxlY3RvclwiOiBcInNwYW4uYS1zaXplLWJhc2UuYS1jb2xvci1iYXNlLnB1aXMtYm9sZC13ZWlnaHQtdGV4dFwiLFxuICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgIFwiY2xhc3NcIjogXCJyZWZpbmVtZW50LXRpdGxlXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIFwic2VsZWN0b3JcIjogXCJ1bDpudGgtb2YtdHlwZSgxKSA+IHNwYW4uYS1kZWNsYXJhdGl2ZSA+IHNwYW4gPiBsaVwiLFxuICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgIFwibmFtZVwiOiBcImZyb21fdGV4dFwiLFxuICAgICAgICBcImNsaWNrYWJsZVwiOiB0cnVlLFxuICAgICAgICBcImNsaWNrX3NlbGVjdG9yXCI6IFwiYVwiLFxuICAgICAgICBcImRpcmVjdF9jaGlsZFwiOiB0cnVlLFxuICAgICAgICBcImNoaWxkcmVuXCI6IFt7IFwic2VsZWN0b3JcIjogXCJpbnB1dFt0eXBlPSdjaGVja2JveCddXCIgfV0sXG4gICAgfSxcbl07XG5leHBvcnQgY29uc3QgcmVjaXBlcyA9IFtcbiAgICB7XG4gICAgICAgIFwibWF0Y2hcIjogXCIvXCIsXG4gICAgICAgIFwibWF0Y2hfbWV0aG9kXCI6IFwidXJsXCIsXG4gICAgICAgIFwic2VsZWN0b3JcIjogXCJodG1sXCIsXG4gICAgICAgIFwiY2hpbGRyZW5cIjogW1xuICAgICAgICAgICAgeyBcInNlbGVjdG9yXCI6IFwiaGVhZFwiLCBcImNoaWxkcmVuXCI6IFt7IFwic2VsZWN0b3JcIjogXCJ0aXRsZVwiLCBcImFkZF90ZXh0XCI6IHRydWUgfV0gfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiYm9keVwiLFxuICAgICAgICAgICAgICAgIFwiY2hpbGRyZW5cIjogW25hdl0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgICBcIm1hdGNoXCI6IFwiL3NcIixcbiAgICAgICAgXCJtYXRjaF9tZXRob2RcIjogXCJ1cmxcIixcbiAgICAgICAgXCJzZWxlY3RvclwiOiBcImh0bWxcIixcbiAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICB7IFwic2VsZWN0b3JcIjogXCJoZWFkXCIsIFwiY2hpbGRyZW5cIjogW3sgXCJzZWxlY3RvclwiOiBcInRpdGxlXCIsIFwiYWRkX3RleHRcIjogdHJ1ZSB9XSB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJib2R5XCIsXG4gICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgIG5hdixcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcIiNzLXJlZmluZW1lbnRzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJyZWZpbmVtZW50c1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiZGl2LmEtc2VjdGlvbi5hLXNwYWNpbmctbm9uZTpub3QoOmhhcygjbi10aXRsZSkpOmhhcyhzcGFuLmEtc2l6ZS1iYXNlLmEtY29sb3ItYmFzZS5wdWlzLWJvbGQtd2VpZ2h0LXRleHQpOmhhcyh1bCBzcGFuLmEtZGVjbGFyYXRpdmUgPiBzcGFuID4gbGkpOm5vdCgjcmV2aWV3c1JlZmluZW1lbnRzKTpub3QoI2RlcGFydG1lbnRzKTpub3QoI3ByaWNlUmVmaW5lbWVudHMpOm5vdCgjZmlsdGVycylcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiZnJvbV90ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGV4dF9zZWxlY3RvclwiOiBcInNwYW4uYS1zaXplLWJhc2UuYS1jb2xvci1iYXNlLnB1aXMtYm9sZC13ZWlnaHQtdGV4dFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IHJlZmluZW1lbnRfb3B0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiI2RlcGFydG1lbnRzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImRlcGFydG1lbnRzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2hpbGRyZW5cIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJsaSBhXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRfdGV4dFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImZyb21fdGV4dFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xpY2thYmxlXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCIjcmV2aWV3c1JlZmluZW1lbnRzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcInJldmlld3NfcmVmaW5lbWVudHNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImxpIGFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiZnJvbV90ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGlja2FibGVcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImRpdi5zLW1haW4tc2xvdC5zLXJlc3VsdC1saXN0LnMtc2VhcmNoLXJlc3VsdHNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcInNlYXJjaF9yZXN1bHRzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5zZXJ0X3NwbGl0X21hcmtlclwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImluc2VydF9zcGxpdF9tYXJrZXJfZXZlcnlcIjogNCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiAnZGl2W2RhdGEtY29tcG9uZW50LXR5cGU9XCJzLXNlYXJjaC1yZXN1bHRcIl0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRleHRfc2VsZWN0b3JcIjogXCJzcGFuLmEtc2l6ZS1iYXNlLXBsdXMuYS1jb2xvci1iYXNlLmEtdGV4dC1ub3JtYWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiZnJvbV90ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xhc3NcIjogXCJzZWFyY2gtcmVzdWx0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2hpbGRyZW5cIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJkaXZbZGF0YS1jeT0ndGl0bGUtcmVjaXBlJ10gYVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6IFwicHJvZHVjdC1uYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGlja2FibGVcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJ2aWV3X3Byb2R1Y3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImRpdltkYXRhLWN5PSdyZXZpZXdzLWJsb2NrJ11cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6IFwicHJvZHVjdC1yZXZpZXdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcInNwYW4uYS1pY29uLWFsdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRfdGV4dFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtcmF0aW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJzcGFuLmEtc2l6ZS1iYXNlLnMtdW5kZXJsaW5lLXRleHRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGV4dF9mb3JtYXRcIjogXCJ7fSByZXZpZXdzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6IFwicHJvZHVjdC1yYXRpbmctY291bnRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiZGl2W2RhdGEtY3k9J3ByaWNlLXJlY2lwZSddXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtcHJpY2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImEuYS1saW5rLW5vcm1hbCA+IHNwYW4uYS1wcmljZSA+IHNwYW4uYS1vZmZzY3JlZW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiZGl2W2RhdGEtY3k9J2RlbGl2ZXJ5LXJlY2lwZSddXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRfdGV4dFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xhc3NcIjogXCJwcm9kdWN0LWRlbGl2ZXJ5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJzcGFuLnMtcGFnaW5hdGlvbi1zdHJpcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwicGFnaW5hdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiLnMtcGFnaW5hdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiZnJvbV90ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xpY2thYmxlXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgXCJtYXRjaFwiOiBcIiNwcm9kdWN0VGl0bGVcIixcbiAgICAgICAgXCJtYXRjaF90ZXh0XCI6IFwiXCIsXG4gICAgICAgIFwic2VsZWN0b3JcIjogXCJodG1sXCIsXG4gICAgICAgIFwidGVybWluYXRlXCI6IFwicmV0dXJuICEhYXJndW1lbnRzWzBdXCIsXG4gICAgICAgIFwidGVybWluYXRlX2NhbGxiYWNrXCI6IFwicmV0dXJuIGFyZ3VtZW50c1swXVwiLFxuICAgICAgICBcImNoaWxkcmVuXCI6IFtcbiAgICAgICAgICAgIHsgXCJzZWxlY3RvclwiOiBcImhlYWRcIiwgXCJjaGlsZHJlblwiOiBbeyBcInNlbGVjdG9yXCI6IFwidGl0bGVcIiwgXCJhZGRfdGV4dFwiOiB0cnVlIH1dIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImJvZHlcIixcbiAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgbmF2LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiI2NlbnRlckNvbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtY2FyZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbGVjdG9yXCI6IFwiI3RpdGxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZWVwX2F0dHJcIjogW1wiaWRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCIjYXZlcmFnZUN1c3RvbWVyUmV2aWV3c1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6IFwicmV2aWV3XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2hpbGRyZW5cIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJzcGFuLmEtaWNvbi1hbHRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCIjYWNyQ3VzdG9tZXJSZXZpZXdUZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRfdGV4dFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcIiNhcGV4X2Rlc2t0b3BfbmV3QWNjb3JkaW9uUm93ICNjb3JlUHJpY2VEaXNwbGF5X2Rlc2t0b3BfZmVhdHVyZV9kaXYgc3Bhbi5hLXByaWNlLmFvay1hbGlnbi1jZW50ZXIucmVpbnZlbnRQcmljZVByaWNlVG9QYXlNYXJnaW4ucHJpY2VUb1BheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGV4dF9mb3JtYXRcIjogXCJQcmljZToge31cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtcHJpY2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcIiN0d2lzdGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xhc3NcIjogXCJwcm9kdWN0LW9wdGlvbnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImRpdi5hLXJvdzpoYXMobGFiZWwuYS1mb3JtLWxhYmVsKTpoYXMoc3Bhbi5zZWxlY3Rpb24pXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCJsYWJlbC5hLWZvcm0tbGFiZWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcInNwYW4uc2VsZWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcIiNhZGRUb0NhcnQ6aGFzKCNidXktbm93LWJ1dHRvbilcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImFkZF90b19jYXJ0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0b3JcIjogXCIjcHJvZHVjdEZhY3RzRGVza3RvcEV4cGFuZGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtZmFjdHNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcImRpdi5taXItbGF5b3V0LURFTElWRVJZX0JMT0NLLXNsb3QtUFJJTUFSWV9ERUxJVkVSWV9NRVNTQUdFX0xBUkdFXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkX3RleHRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtZGVsaXZlcnlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RvclwiOiBcIiNidXktbm93LWJ1dHRvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZF90ZXh0XCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xpY2thYmxlXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImJ1eV9ub3dcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGFzc1wiOiBcInByb2R1Y3QtYnV5LW5vd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJlZm9yZV9ob29rXCI6IGBcbmNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0aXRsZVwiKS5pbm5lclRleHRcbmNvbnN0IHByaWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInNwYW4uYS1wcmljZS5hb2stYWxpZ24tY2VudGVyLnJlaW52ZW50UHJpY2VQcmljZVRvUGF5TWFyZ2luLnByaWNlVG9QYXlcIikuaW5uZXJUZXh0XG5jb25zdCBvcHRpb25zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI3R3aXN0ZXIgZGl2LmEtcm93OmhhcyhsYWJlbC5hLWZvcm0tbGFiZWwpOmhhcyhzcGFuLnNlbGVjdGlvbilcIikpLm1hcChhID0+ICh7bGFiZWw6IGEucXVlcnlTZWxlY3RvcihcImxhYmVsLmEtZm9ybS1sYWJlbFwiKS5pbm5lclRleHQsIHZhbHVlOiBhLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuLnNlbGVjdGlvblwiKS5pbm5lclRleHR9KSlcbmNvbnN0IG9wdGlvbnNfZGljdCA9IHt9XG5mb3IgKGNvbnN0IG9wdGlvbiBvZiBvcHRpb25zKSB7XG4gICAgb3B0aW9uc19kaWN0W29wdGlvbltcImxhYmVsXCJdLnJlcGxhY2UoXCI6IFwiLCBcIlwiKV0gPSBvcHRpb25bXCJ2YWx1ZVwiXVxufVxuY29uc3QgYXNpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dCNBU0lOXCIpLnZhbHVlXG5jb25zb2xlLmxvZyh7dGl0bGUsIHByaWNlLCBvcHRpb25zOiBvcHRpb25zX2RpY3QsIGFzaW59KVxucmV0dXJuIHt0aXRsZSwgcHJpY2UsIG9wdGlvbnM6IG9wdGlvbnNfZGljdCwgYXNpbn1cbmAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICAgIFwibWF0Y2hcIjogXCIvYXAvc2lnbmluXCIsXG4gICAgICAgIFwibWF0Y2hfbWV0aG9kXCI6IFwidXJsXCIsXG4gICAgICAgIFwidGVybWluYXRlXCI6IFwicmV0dXJuICEhYXJndW1lbnRzWzBdXCIsXG4gICAgICAgIFwidGVybWluYXRlX2NhbGxiYWNrXCI6IFwicmV0dXJuIGFyZ3VtZW50c1swXVwiLFxuICAgICAgICBcInNlbGVjdG9yXCI6IFwiaHRtbFwiLFxuICAgIH0sXG5dO1xuIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyByZWNpcGVzIH0gZnJvbSAnLi9yZWNpcGUnO1xubGV0IGludGVyYWN0aW9ucyA9IFtdO1xuY29uc3QgaW50ZXJhY3Rpb25zTGltaXQgPSAxMDtcbmxldCBzY3JlZW5zaG90cyA9IFtdO1xuY29uc3Qgc2NyZWVuc2hvdExpbWl0ID0gMTA7XG5sZXQgYWN0aW9uU2VxdWVuY2VJZCA9IDA7XG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgKCgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnc2F2ZURhdGEnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmVEYXRhICcsIG1lc3NhZ2UuZGF0YS5ldmVudFR5cGUpO1xuICAgICAgICAgICAgICAgIGFjdGlvblNlcXVlbmNlSWQrKztcbiAgICAgICAgICAgICAgICBtZXNzYWdlLmRhdGEuYWN0aW9uU2VxdWVuY2VJZCA9IGFjdGlvblNlcXVlbmNlSWQ7XG4gICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25zLnB1c2gobWVzc2FnZS5kYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJhY3Rpb25zLmxlbmd0aCA+IGludGVyYWN0aW9uc0xpbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoeyBpbnRlcmFjdGlvbnM6IFtdIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuaW50ZXJhY3Rpb25zIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcmVJbnRlcmFjdGlvbnMgPSByZXN1bHQuY29uY2F0KGludGVyYWN0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGludGVyYWN0aW9ucy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBpbnRlcmFjdGlvbnM6IHN0b3JlSW50ZXJhY3Rpb25zIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ2FwdHVyZSBzY3JlZW5zaG90IG9uIGRlbWFuZFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnY2FwdHVyZVNjcmVlbnNob3QnKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NyZWVuc2hvdERhdGFVcmwgPSB5aWVsZCBjYXB0dXJlU2NyZWVuc2hvdCgpO1xuICAgICAgICAgICAgICAgIGlmIChzY3JlZW5zaG90RGF0YVVybCkge1xuICAgICAgICAgICAgICAgICAgICBzY3JlZW5zaG90cy5wdXNoKFtzY3JlZW5zaG90RGF0YVVybCwgbWVzc2FnZS5zY3JlZW5zaG90SWRdKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjcmVlbnNob3RzLmxlbmd0aCA+IHNjcmVlbnNob3RMaW1pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHlpZWxkIGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldCh7IHNjcmVlbnNob3RzOiBbXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5zY3JlZW5zaG90cyB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlU2NyZWVuc2hvdHMgPSByZXN1bHQuY29uY2F0KHNjcmVlbnNob3RzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbnNob3RzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBzY3JlZW5zaG90czogc3RvcmVTY3JlZW5zaG90cyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VuZFJlc3BvbnNlKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gY2FwdHVyZSBzY3JlZW5zaG90JyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEb3dubG9hZCBkYXRhIG9uIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnZG93bmxvYWREYXRhJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csICctJyk7IC8vIENyZWF0ZSBhIHRpbWVzdGFtcCBmb3IgdGhlIGZvbGRlciBuYW1lXG4gICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyTmFtZSA9IGBEQVRBL1NFU1NJT05fJHt0aW1lc3RhbXB9YDtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBmb2xkZXIgd2l0aCB0aGUgdGltZXN0YW1wIGFuZCBkb3dubG9hZCBzZXNzaW9uIGluZm9cbiAgICAgICAgICAgICAgICBjaHJvbWUuZG93bmxvYWRzLmRvd25sb2FkKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnZGF0YTp0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgsJyArIGVuY29kZVVSSUNvbXBvbmVudChgU2Vzc2lvbiBkYXRhIGZvciB0aW1lc3RhbXA6ICR7dGltZXN0YW1wfSwgdXNlciBpZDogJHttZXNzYWdlLnVzZXJJZH1gKSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IGAke2ZvbGRlck5hbWV9L3Nlc3Npb25faW5mby50eHRgLFxuICAgICAgICAgICAgICAgICAgICBzYXZlQXM6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSwgKGRvd25sb2FkSWQpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGFsbCBpbnRlcmFjdGlvbnMgaW4gYSBzaW5nbGUgSlNPTiBmaWxlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNuYXBzaG90cyA9IHlpZWxkIGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldCh7IGh0bWxTbmFwc2hvdHM6IFtdIH0pO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaHRtbFNuYXBzaG90cyA9IHNuYXBzaG90cy5odG1sU25hcHNob3RzIHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5yZW1vdmUoJ2h0bWxTbmFwc2hvdHMnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaHRtbFNuYXBzaG90cyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdDEgPSB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoeyBpbnRlcmFjdGlvbnM6IFtdIH0pO1xuICAgICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5yZW1vdmUoJ2ludGVyYWN0aW9ucycpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcmVJbnRlcmFjdGlvbnMgPSByZXN1bHQxLmludGVyYWN0aW9ucyB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc3RvcmVJbnRlcmFjdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBzdG9yZUludGVyYWN0aW9ucyA9IHN0b3JlSW50ZXJhY3Rpb25zLmNvbmNhdChpbnRlcmFjdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvbnMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JkZXJEZXRhaWxzID0geWllbGQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KHsgb3JkZXJEZXRhaWxzOiBbXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b3Jlb3JkZXJEZXRhaWxzID0gb3JkZXJEZXRhaWxzLm9yZGVyRGV0YWlscyB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwucmVtb3ZlKCdvcmRlckRldGFpbHMnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZnVsbERhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sU25hcHNob3RzOiBodG1sU25hcHNob3RzLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25zOiBzdG9yZUludGVyYWN0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyRGV0YWlsczogc3RvcmVvcmRlckRldGFpbHMsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGludGVyYWN0aW9uc0RhdGEgPSBKU09OLnN0cmluZ2lmeShmdWxsRGF0YSwgbnVsbCwgMik7XG4gICAgICAgICAgICAgICAgICAgIGNocm9tZS5kb3dubG9hZHMuZG93bmxvYWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnZGF0YTp0ZXh0L2pzb247Y2hhcnNldD11dGYtOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KGludGVyYWN0aW9uc0RhdGEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IGAke2ZvbGRlck5hbWV9L2ludGVyYWN0aW9ucy5qc29uYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVBczogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdDIgPSB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoeyBzY3JlZW5zaG90czogW10gfSk7XG4gICAgICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnJlbW92ZSgnc2NyZWVuc2hvdHMnKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b3JlU2NyZWVuc2hvdHMgPSByZXN1bHQyLnNjcmVlbnNob3RzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICBzdG9yZVNjcmVlbnNob3RzID0gc3RvcmVTY3JlZW5zaG90cy5jb25jYXQoc2NyZWVuc2hvdHMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdG9yZVNjcmVlbnNob3RzKTtcbiAgICAgICAgICAgICAgICAgICAgc2NyZWVuc2hvdHMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSBhbGwgc2NyZWVuc2hvdHMgYXMgaW5kaXZpZHVhbCBqcGcgZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgc3RvcmVTY3JlZW5zaG90cy5mb3JFYWNoKChzY3JlZW5zaG90LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2NyZWVuc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGAke2ZvbGRlck5hbWV9LyR7c2NyZWVuc2hvdFsxXS5yZXBsYWNlKC9bOi5dL2csIFwiLVwiKX0uanBnYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNocm9tZS5kb3dubG9hZHMuZG93bmxvYWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc2NyZWVuc2hvdFswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUFzOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBjaHJvbWUuc3RvcmFnZS5sb2NhbC5jbGVhcigpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtZXNzYWdlLmFjdGlvbiA9PT0gJ2NsZWFyTWVtb3J5Q2FjaGUnKSB7XG4gICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25zID0gW107XG4gICAgICAgICAgICAgICAgc2NyZWVuc2hvdHMgPSBbXTtcbiAgICAgICAgICAgICAgICBhY3Rpb25TZXF1ZW5jZUlkID0gMDtcbiAgICAgICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gY2hyb21lLnN0b3JhZ2UubG9jYWwuY2xlYXIoKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGhhbmRsaW5nIG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICAgICAgc2VuZFJlc3BvbnNlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICB9XG4gICAgfSkpKCk7XG4gICAgcmV0dXJuIHRydWU7IC8vIEtlZXBzIHRoZSBtZXNzYWdlIGNoYW5uZWwgb3BlbiBmb3IgYXN5bmMgcmVzcG9uc2VzXG59KTtcbi8vIENhcHR1cmUgdGhlIHNjcmVlbnNob3QgaW4gdGhlIGN1cnJlbnQgdGFiXG5mdW5jdGlvbiBjYXB0dXJlU2NyZWVuc2hvdCgpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgW3RhYl0gPSB5aWVsZCBjaHJvbWUudGFicy5xdWVyeSh7IGFjdGl2ZTogdHJ1ZSwgY3VycmVudFdpbmRvdzogdHJ1ZSB9KTtcbiAgICAgICAgICAgIGlmICh0YWIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geWllbGQgY2hyb21lLnRhYnMuY2FwdHVyZVZpc2libGVUYWIodGFiLndpbmRvd0lkLCB7IGZvcm1hdDogJ2pwZWcnLCBxdWFsaXR5OiAyNSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhcHR1cmluZyBzY3JlZW5zaG90OicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhc2hDb2RlKHN0cikge1xuICAgIGxldCBoYXNoID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBzdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgaGFzaCB8PSAwO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcIkhhc2ggdmFsdWUgYmVmb3JlIHJldHVybjpcIiwgaGFzaCk7XG4gICAgcmV0dXJuIGhhc2gudG9TdHJpbmcoKTtcbn1cbi8vIGxpc3RlbiB0byBzd2l0Y2hlcyBiZXR3ZWVuIGFjdGl2YXRlZCB0YWJzXG5jaHJvbWUudGFicy5vbkFjdGl2YXRlZC5hZGRMaXN0ZW5lcigoYWN0aXZlSW5mbykgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdGFiSWQgPSBhY3RpdmVJbmZvLnRhYklkO1xuICAgICAgICBjb25zdCB0YWIgPSB5aWVsZCBjaHJvbWUudGFicy5nZXQodGFiSWQpO1xuICAgICAgICBpZiAoIXRhYikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGdldCB0YWIgd2l0aCBJRDogJHt0YWJJZH1gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhgU3dpdGNoZWQgdG8gdGFiICR7dGFiSWR9IHdpdGggVVJMOiAke3RhYi51cmx9YCk7XG4gICAgICAgIGlmICh0YWIudXJsICYmIHRhYi51cmwuaW5jbHVkZXMoJ2FtYXpvbi5jb20nKSkge1xuICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFNuYXBzaG90SWQgPSBgaHRtbF8ke2hhc2hDb2RlKHRhYi51cmwpfV8ke3RpbWVzdGFtcH1gO1xuICAgICAgICAgICAgY2hyb21lLnRhYnMuc2VuZE1lc3NhZ2UodGFiSWQsIHsgYWN0aW9uOiAnZ2V0SFRNTCcgfSwgKHJlc3BvbnNlKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBodG1sQ29udGVudCA9IHJlc3BvbnNlID09PSBudWxsIHx8IHJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXNwb25zZS5odG1sO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoeyBodG1sU25hcHNob3RzOiB7fSB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBodG1sU25hcHNob3RzID0gcmVzdWx0Lmh0bWxTbmFwc2hvdHMgfHwge307XG4gICAgICAgICAgICAgICAgaHRtbFNuYXBzaG90c1tjdXJyZW50U25hcHNob3RJZF0gPSBodG1sQ29udGVudDtcbiAgICAgICAgICAgICAgICB5aWVsZCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBodG1sU25hcHNob3RzIH0pO1xuICAgICAgICAgICAgICAgIGFjdGlvblNlcXVlbmNlSWQrKztcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25TZXF1ZW5jZUlkOiBhY3Rpb25TZXF1ZW5jZUlkLFxuICAgICAgICAgICAgICAgICAgICBldmVudFR5cGU6IFwidGFiQWN0aXZhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldF91cmw6IHRhYi51cmwsXG4gICAgICAgICAgICAgICAgICAgIGh0bWxTbmFwc2hvdElkOiBjdXJyZW50U25hcHNob3RJZCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGludGVyYWN0aW9ucy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmIChpbnRlcmFjdGlvbnMubGVuZ3RoID4gaW50ZXJhY3Rpb25zTGltaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHlpZWxkIGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldCh7IGludGVyYWN0aW9uczogW10gfSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5pbnRlcmFjdGlvbnMgfHwgW107XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdG9yZUludGVyYWN0aW9ucyA9IHJlc3VsdC5jb25jYXQoaW50ZXJhY3Rpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25zLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IGludGVyYWN0aW9uczogc3RvcmVJbnRlcmFjdGlvbnMgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICBjb25zdCBzY3JlZW5zaG90RGF0YVVybCA9IHlpZWxkIGNocm9tZS50YWJzLmNhcHR1cmVWaXNpYmxlVGFiKHRhYi53aW5kb3dJZCwgeyBmb3JtYXQ6ICdqcGVnJywgcXVhbGl0eTogMjUgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NyZWVuc2hvdElkID0gYHNjcmVlbnNob3RfJHt0aW1lc3RhbXB9YDtcbiAgICAgICAgICAgICAgICBpZiAoc2NyZWVuc2hvdERhdGFVcmwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NyZWVuc2hvdHMucHVzaChbc2NyZWVuc2hvdERhdGFVcmwsIHNjcmVlbnNob3RJZF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NyZWVuc2hvdHMubGVuZ3RoID4gc2NyZWVuc2hvdExpbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0geWllbGQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KHsgc2NyZWVuc2hvdHM6IFtdIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnNjcmVlbnNob3RzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RvcmVTY3JlZW5zaG90cyA9IHJlc3VsdC5jb25jYXQoc2NyZWVuc2hvdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuc2hvdHMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IHNjcmVlbnNob3RzOiBzdG9yZVNjcmVlbnNob3RzIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB0YWIgYWN0aXZhdGUgaGFuZGxlcjonLCBlcnJvcik7XG4gICAgfVxufSkpO1xuZnVuY3Rpb24gc2VsZWN0UmVjaXBlKHRhYklkLCB1cmwpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgICAgIGNvbnN0IHBhdGggPSBwYXJzZWRVcmwucGF0aG5hbWU7XG4gICAgICAgIGZvciAoY29uc3QgcmVjaXBlIG9mIHJlY2lwZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoTWV0aG9kID0gcmVjaXBlLm1hdGNoX21ldGhvZCB8fCBcInRleHRcIjtcbiAgICAgICAgICAgIGlmIChtYXRjaE1ldGhvZCA9PT0gXCJ0ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHNjcmlwdCBpbiB0YWIgdG8gY2hlY2sgZm9yIG1hdGNoaW5nIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW3sgcmVzdWx0OiBoYXNNYXRjaCB9XSA9IHlpZWxkIGNocm9tZS5zY3JpcHRpbmcuZXhlY3V0ZVNjcmlwdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHsgdGFiSWQgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmM6IChzZWxlY3RvciwgbWF0Y2hUZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQgJiYgKCFtYXRjaFRleHQgfHwgKChfYiA9IChfYSA9IGVsZW1lbnQudGV4dENvbnRlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1hdGNoVGV4dC50b0xvd2VyQ2FzZSgpKSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogZmFsc2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbcmVjaXBlLm1hdGNoLCByZWNpcGUubWF0Y2hfdGV4dCB8fCBcIlwiXVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc01hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVjaXBlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY2hlY2tpbmcgdGV4dCBtYXRjaDpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1hdGNoTWV0aG9kID09PSBcInVybFwiICYmIHJlY2lwZS5tYXRjaCA9PT0gcGF0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWNpcGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBtYXRjaGluZyByZWNpcGUgZm91bmQgZm9yIHBhdGg6ICR7cGF0aH1gKTtcbiAgICB9KTtcbn1cbmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcigobWVzc2FnZSwgc2VuZGVyLCBzZW5kUmVzcG9uc2UpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnZ2V0UmVjaXBlJyAmJiAoKF9hID0gc2VuZGVyLnRhYikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlkKSkge1xuICAgICAgICBzZWxlY3RSZWNpcGUoc2VuZGVyLnRhYi5pZCwgbWVzc2FnZS51cmwpXG4gICAgICAgICAgICAudGhlbigocmVjaXBlKSA9PiB7XG4gICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyByZWNpcGU6IHJlY2lwZSB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIEluZGljYXRlIHRoYXQgc2VuZFJlc3BvbnNlIHdpbGwgYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5XG4gICAgfVxufSk7XG4iXSwibmFtZXMiOlsibmF2IiwicmVjaXBlcyIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJpbnRlcmFjdGlvbnMiLCJzY3JlZW5zaG90cyIsImFjdGlvblNlcXVlbmNlSWQiLCJjaHJvbWUiLCJydW50aW1lIiwib25NZXNzYWdlIiwiYWRkTGlzdGVuZXIiLCJtZXNzYWdlIiwic2VuZGVyIiwic2VuZFJlc3BvbnNlIiwiYWN0aW9uIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJldmVudFR5cGUiLCJwdXNoIiwibGVuZ3RoIiwic3RvcmFnZSIsImxvY2FsIiwiZ2V0Iiwic3RvcmVJbnRlcmFjdGlvbnMiLCJjb25jYXQiLCJzZXQiLCJzdWNjZXNzIiwic2NyZWVuc2hvdERhdGFVcmwiLCJ0aGlzIiwidGFiIiwidGFicyIsInF1ZXJ5IiwiYWN0aXZlIiwiY3VycmVudFdpbmRvdyIsImNhcHR1cmVWaXNpYmxlVGFiIiwid2luZG93SWQiLCJmb3JtYXQiLCJxdWFsaXR5IiwiZXJyb3IiLCJjYXB0dXJlU2NyZWVuc2hvdCIsInNjcmVlbnNob3RJZCIsInN0b3JlU2NyZWVuc2hvdHMiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZXBsYWNlIiwiZm9sZGVyTmFtZSIsImRvd25sb2FkcyIsImRvd25sb2FkIiwidXJsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwidXNlcklkIiwiZmlsZW5hbWUiLCJzYXZlQXMiLCJkb3dubG9hZElkIiwiaHRtbFNuYXBzaG90cyIsInJlbW92ZSIsInJlc3VsdDEiLCJzdG9yZW9yZGVyRGV0YWlscyIsIm9yZGVyRGV0YWlscyIsImZ1bGxEYXRhIiwiaW50ZXJhY3Rpb25zRGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXN1bHQyIiwiZm9yRWFjaCIsInNjcmVlbnNob3QiLCJpbmRleCIsIm9uQWN0aXZhdGVkIiwiYWN0aXZlSW5mbyIsInRhYklkIiwiaW5jbHVkZXMiLCJjdXJyZW50U25hcHNob3RJZCIsInN0ciIsImhhc2giLCJpIiwiY2hhckNvZGVBdCIsInRvU3RyaW5nIiwiaGFzaENvZGUiLCJzZW5kTWVzc2FnZSIsInJlc3BvbnNlIiwiaHRtbENvbnRlbnQiLCJodG1sIiwidGFyZ2V0X3VybCIsImh0bWxTbmFwc2hvdElkIiwiX2EiLCJpZCIsInBhdGgiLCJVUkwiLCJwYXRobmFtZSIsInJlY2lwZSIsIm1hdGNoTWV0aG9kIiwibWF0Y2hfbWV0aG9kIiwiaGFzTWF0Y2giLCJzY3JpcHRpbmciLCJleGVjdXRlU2NyaXB0IiwidGFyZ2V0IiwiZnVuYyIsInNlbGVjdG9yIiwibWF0Y2hUZXh0IiwiX2IiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJ0b0xvd2VyQ2FzZSIsImFyZ3MiLCJtYXRjaCIsIm1hdGNoX3RleHQiLCJFcnJvciIsInNlbGVjdFJlY2lwZSIsImNhdGNoIl0sInNvdXJjZVJvb3QiOiIifQ==